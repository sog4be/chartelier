# Test Design Specification

## 目次

- [1. はじめに](#1-はじめに)
- [2. テストレベル](#2-テストレベル)
- [3. テスト要件](#3-テスト要件)
  - [3.1 機能要件（正常系）](#31-機能要件正常系)
  - [3.2 機能要件（異常系）](#32-機能要件異常系)
  - [3.3 非機能要件](#33-非機能要件)
- [4. テスト要素と観点（MECE整理）](#4-テスト要素と観点mece整理)
  - [4.1 入力データ（CSV/JSON）- 等価分割 × 境界値](#41-入力データcsvjson-等価分割-境界値)
  - [4.2 クエリ（自然言語）](#42-クエリ自然言語)
  - [4.3 オプション](#43-オプション)
  - [4.4 パターン／テンプレート／補助要素](#44-パターンテンプレート補助要素)
  - [4.5 エラー応答（構造化JSON）](#45-エラー応答構造化json)
  - [4.6 非機能（性能・可用性・運用）](#46-非機能性能可用性運用)
- [5. トレーサビリティ（要件→テスト）](#5-トレーサビリティ要件テスト)
- [6. テストケース一覧（代表）](#6-テストケース一覧代表)
  - [6.1 単体テスト（UT）](#61-単体テストut)
  - [6.1.1 RequestValidator / DataValidator](#611-requestvalidator-datavalidator)
  - [6.1.2 PatternSelector / ChartSelector](#612-patternselector-chartselector)
  - [6.1.3 DataProcessor / DataMapper / ChartBuilder](#613-dataprocessor-datamapper-chartbuilder)
  - [6.2 結合テスト（IT）](#62-結合テストit)
  - [6.3 統合テスト（ST）](#63-統合テストst)
  - [6.3.1 MCPエンドツーエンド](#631-mcpエンドツーエンド)
  - [6.3.2 エラーポリシー／ログ・PII](#632-エラーポリシーログ-pii)
  - [6.4 E2E（ユーザーストーリー）](#64-e2eユーザーストーリー)
- [7. 非機能テスト](#7-非機能テスト)
  - [7.1 性能・スケーラビリティ](#71-性能-スケーラビリティ)
  - [7.2 可用性・信頼性](#72-可用性-信頼性)
  - [7.3 運用・監視](#73-運用-監視)
- [8. データ設計（テストフィクスチャ）](#8-データ設計テストフィクスチャ)
- [9. 実施条件・環境](#9-実施条件-環境)
- [10. 合格基準](#10-合格基準)
- [11. リスクと迂回策](#11-リスクと迂回策)
- [12. 自動化・CI戦略](#12-自動化-ci戦略)
- [13. 代表テストシナリオ詳細（抜粋）](#13-代表テストシナリオ詳細抜粋)
  - [13.1 「セル上限超過→サンプリング→描画」](#131-セル上限超過サンプリング描画)
  - [13.2 「LLMタイムアウト→P13フォールバック」](#132-llmタイムアウト-p13フォールバック)
  - [13.3 「PNG失敗→SVGフォールバック」](#133-png失敗-svgフォールバック)
- [14. 9パターン網羅チェックリスト](#14-9パターン網羅チェックリスト)

## 1. はじめに

**目的**

- 要件（Functional/Non-Functional）に対する**検証戦略・観点・テストケース**を定義する。
- MCP準拠の**ステートレス可視化ツール**として、**9パターン制約**と*フェイルセーフ（P13フォールバック）*を中心に品質担保する。

**背景**

- LLM起因の可視化品質の不安定さに対し、**事前検証済みテンプレート**と**制約付き有限状態**で安定品質を目指すプロダクト。
- Phase 1はMCPツールサーバー＋コア機能、Phase 2でFunction Calling/REST拡張。

**スコープ**

- **Phase 1（必須/P0）**: MCP、9パターン、エラーハンドリング、P13フォールバック、PNG/SVG出力、データ制約/サンプリング、監視・運用IF。
- **Phase 2（拡張/P1-P2）**: Function Calling、REST、追加グラフ、テーマ等。
→ 本書は**Phase 1で必須**、Phase 2は**将来有効化時に実施**する。

## 2. テストレベル

| レベル | 目的 | スコープ | 代表ツール |
| --- | --- | --- | --- |
| **単体テスト（UT）** | クラス/関数単体の仕様遵守 | RequestValidator / Coordinator / DataValidator / PatternSelector / ChartSelector / DataProcessor / DataMapper / ChartBuilder / LLMClient（モック） | pytest |
| **結合テスト（IT）** | 隣接モジュールの接続とデータ授受 | Coordinator中心にProcessingLayer/ChartBuilder連携 | pytest + fixtures |
| **統合テスト（ST）** | システム全体のフロー（MCP入口～画像出力） | MCPHandler経由のE2Eパス（ただし外部はモック可能） | pytest + JSON-RPCクライアント |
| **E2Eテスト（E2E）** | ユーザーストーリー達成度（US-001～003） | 実行バイナリ/コンテナを起動し実運用近似で確認 | smoke / 回帰 / シナリオ |
| **非機能（NFT）** | 性能・可用性・スケール・運用性 | P80<10s、100並行、監視/ログ/トレース | k6/Locust, Prometheus, OTel |

## 3. テスト要件

### 3.1 機能要件（正常系）

- **FR-010/011/012**: MCPツール／Function Calling／REST（Phase 2）で指定スキーマ通り入出力。
- **FR-020**: CSV/JSON（UTF-8、ヘッダ必須、10,000×100 ≤ 1,000,000セル）。超過は**決定論的等間隔サンプリング**＋警告。区切り子（`,` `\\t` `|`）対応。
- **FR-021**: 自然言語クエリ（ja/en、≤1000字）に基づき**適切なグラフ自動選択**。
- **FR-022**: **3×3（9パターン）制約内で決定。フォールバックはP13（推移×概要）**。
- **FR-030**: PNG（Base64）/SVG（文字列）、解像度/DPI/サイズ指定。
- **FR-031**: 構造化エラー（コード/メッセージ/修正提案/フォールバック情報）を返却。

### 3.2 機能要件（異常系）

- 入力形式不正、サイズ・セル上限超過、ヘッダ欠如、エンコーディング不正、JSON非テーブル、クエリ過長/空、テンプレート未決定、マッピング不成立、PNG生成失敗、LLM失敗、タイムアウト、レート制限等。
- **エラー分類・コード**（Validation/Business/Upstream/System/Rate Limit）準拠、MCPのJSON-RPCコード整合。

### 3.3 非機能要件

- **性能**: P80<10s（NFR-010）、60sタイムアウト（NFR-022）。
- **可用性/信頼性**: 処理成功率99.9%（NFR-020）、フォールバック100%（NFR-023）。
- **スケール**: 水平スケール、100並行（NFR-011, NFR-030, NFR-031）。
- **互換性**: MCP/Function Calling/OpenAPI準拠、UTF-8（NFR-040～043）。
- **運用**: 構造化ログ、メトリクス、トレース、/health, /ready, /metrics（NFR-050～053）。

## 4. テスト要素と観点（MECE整理）

### 4.1 入力データ（CSV/JSON）- **等価分割 × 境界値**

| 要素 | 観点（クラス） | 説明（代表例） |  |
| --- | --- | --- | --- |
| フォーマット | CSV / JSON | JSONは**テーブル変換可能**のみ。ネスト深いJSONはエラー。 |  |
| 文字コード | UTF-8 / 非UTF-8 | 非UTF-8はValidationエラー。 |  |
| 区切り子（CSV） | `,` / `\\t` / \` | \` | 自動判定/指定の双方で正しく解釈。 |
| ヘッダ | あり / なし | なしはValidationエラー（ヘッダ必須）。 |  |
| サイズ | ≤100MB / >100MB | >100MBは**E413**、≤100MBでセル超過はサンプリング。 |  |
| セル数 | ≤1,000,000 / >1,000,000 | 超過は**等間隔サンプリング**＋警告。 |  |
| 行数/列数 | ≤10,000 / ≤100 / 境界値±1 | 10,000超・100超はサンプリング or エラー方針通り。 |  |
| 型 | 数値/日付/文字列/欠損/外れ値 | プロファイルと型推論、警告の付与。日付失敗は文字列＋警告。 |  |

### 4.2 クエリ（自然言語）

| 要素 | 観点（クラス） | 説明 |
| --- | --- | --- |
| 言語 | ja / en / 混在 | 言語推定と応答言語の整合。 |
| 長さ | 1..1000 / 0 / >1000 | 0と>1000はValidationエラー。 |
| 意図1×意図2 | 推移/差異/概要 ×（-, 推移, 差異, 概要） | 9パターンに正しく分類（LLMモックで決定論／失敗時P13）。 |
| 曖昧性 | 明確 / 曖昧 | 曖昧時は適切なフォールバック／代替提案。 |

### 4.3 オプション

| 要素 | 観点 | 説明 |
| --- | --- | --- |
| 出力形式 | png / svg | 画像内容の妥当性（PNG Base64可逆/ SVGにスクリプト混入なし）。 |
| DPI | 72 / 96 / 300 / 範囲外 | 範囲外はValidationエラー。 |
| サイズ | 幅:400..2000 / 高:300..2000 | **max pixels ≤ 4,000,000** 超で縮退（サイズ調整or警告）。 |
| locale | ja / en / 省略 | ラベル/メッセージ言語の整合。 |

### 4.4 パターン／テンプレート／補助要素

| 要素 | 観点 | 説明 |
| --- | --- | --- |
| パターン | P01..P32（表定義） | 9パターンの用途に合致。LLM失敗時は**P13**。 |
| テンプレート | 既定/候補選択/不正ID | 不正IDはデフォルトへフォールバック。 |
| 補助要素 | 許可表/最大3件/矛盾 | 不適切な組合せは自動除去し基本チャート生成継続。 |

### 4.5 エラー応答（構造化JSON）

- **コードの妥当性**（E400/E413/E415/E422/E424/E408/E429/E500/E503）
- **ヒント/修正提案**を必ず含む
- **MCPのJSON-RPCコード**と整合（-32602/-32500/-32603等）

### 4.6 非機能（性能・可用性・運用）

- レイテンシ（P80<10s）、タイムアウト（60s）、並行100、スループット、SLO達成（99.9%）
- ログ（PII禁止、構造化）、メトリクス（Prometheus名）、トレース（スパン/属性）

## 5. トレーサビリティ（要件→テスト）

| 要件ID | 主要テスト |
| --- | --- |
| FR-010（MCP） | ST-MCP-001/002、E2E-001 |
| FR-020（CSV/JSON） | UT-VAL-001～014、IT-DATA-1x、ST-DATA-0x |
| FR-021（NLU） | UT-PS-001～006、IT-SEL-0x、ST-PAT-0x |
| FR-022（9パターン/P13） | UT-PS-\*, ST-PAT-0x、E2E-002 |
| FR-030（画像出力） | UT-CB-\*, ST-IMG-0x |
| FR-031（エラー） | UT-ERR-\*, ST-ERR-0x、E2E-003 |
| NFR-010/022（性能/TO） | NFT-PERF-0x |
| NFR-011/030/031（並行/スケール/ステートレス） | NFT-CONC-0x、NFT-STATE-001 |
| NFR-040～043（互換性） | ST-MCP-\*, ST-ENC-001 |
| NFR-050～053（運用） | NFT-OPS-0x |

## 6. テストケース一覧（代表）

> 方針: ケースは等価分割×境界値でパラメタライズ。一覧は代表項目を示し、実装ではdata-drivenで網羅する。
> 

### 6.1 単体テスト（UT）

### 6.1.1 RequestValidator / DataValidator

| TestID | 観点 | 手順（要点） | 期待結果 |  |
| --- | --- | --- | --- | --- |
| **UT-VAL-001** | 必須項目 | `data`欠落 | E400\_VALIDATION（-32602） |  |
| **UT-VAL-002** | 文字コード | 非UTF-8入力 | E400\_VALIDATION（encodingヒント） |  |
| **UT-VAL-003** | ヘッダ | CSVヘッダなし | E400\_VALIDATION |  |
| **UT-VAL-004** | 区切り子 | `,`/`\\t`/\` | \`をそれぞれ含む正常CSV | 正常パース |
| **UT-VAL-005** | サイズ上限 | 100MB超 | E413\_TOO\_LARGE |  |
| **UT-VAL-006** | セル上限 | 1,000,001セル | 等間隔サンプリング＋警告 |  |
| **UT-VAL-007** | 行境界 | 10,000行/10,001行 | 閾値内正常/サンプリング適用 |  |
| **UT-VAL-008** | 列境界 | 100列/101列 | 閾値内正常/サンプリングorエラー設計どおり |  |
| **UT-VAL-009** | JSON妥当性 | ネストして表にならないJSON | E422\_UNPROCESSABLE（テーブル化不可） |  |
| **UT-VAL-010** | 日付推論 | ISO日付/失敗ケース | 成功はtemporal、失敗はstring＋警告 |  |
| **UT-VAL-011** | 欠損/外れ値 | 欠損率高/外れ値含む | 警告付与（処理継続） |  |
| **UT-VAL-012** | query長 | 0/1/1000/1001文字 | 0/1001はE400、他はOK |  |
| **UT-VAL-013** | options境界 | DPI 72/300、幅400/2000、高300/2000、範囲外 | 範囲内OK/範囲外E400 |  |
| **UT-VAL-014** | max pixels | 4,000,000超 | 縮退（サイズ調整 or 警告） |  |

### 6.1.2 PatternSelector / ChartSelector

| TestID | 観点 | 手順 | 期待結果 |
| --- | --- | --- | --- |
| **UT-PS-001** | 意図分類 | 明確な推移（単系列） | P01 |
| **UT-PS-002** | 意図分類 | 明確な差異 | P02 |
| **UT-PS-003** | 意図分類 | 分布 | P03 |
| **UT-PS-004** | 意図×補助 | 「複数系列の時間比較」 | P12 |
| **UT-PS-005** | LLM失敗 | タイムアウト/無効応答（モック） | **P13**フォールバック |
| **UT-CS-001** | 候補選択 | パターンに対しテンプレート取得 | 既定候補から最適選択 |
| **UT-CS-002** | 不正template\_id | 存在しないID | パターン既定にフォールバック |
| **UT-CS-003** | 補助要素上限 | 4件指定 | 3件に切り詰め |
| **UT-CS-004** | 不適切要素 | テンプレート非対応要素 | 無視し基本描画 |

### 6.1.3 DataProcessor / DataMapper / ChartBuilder

| TestID | 観点 | 手順 | 期待結果 |
| --- | --- | --- | --- |
| **UT-DP-001** | 安全関数限定 | 未登録操作を含むパイプライン | 未登録はスキップ＋警告 |
| **UT-DP-002** | 冪等性 | 同一操作を2回適用 | 結果は1回と等価 |
| **UT-DM-001** | マッピング必須 | 必須エンコーディング欠落 | E422（hint: 候補列） |
| **UT-DM-002** | 型不整合 | 数値要求に文字列 | 自動キャスト試行＋警告（失敗時E422） |
| **UT-CB-001** | 画像生成 | SVG/PNG出力 | SVGは文字列、PNGはBase64可逆 |
| **UT-CB-002** | 生成失敗 | PNG失敗をモック | SVGへフォールバック再試行 |
| **UT-ERR-001** | エラー整形 | 例外→MCPエラー | 構造化エラー＋correlation\_id |

### 6.2 結合テスト（IT）

| TestID | 観点 | 手順 | 期待結果 |
| --- | --- | --- | --- |
| **IT-DATA-010** | CSV→検証→処理 | CSV(区切り子各種)→DataValidator→DataProcessor | メタデータ抽出・必要前処理が正しく適用 |
| **IT-SEL-020** | メタ×意図→パターン→テンプレ | metadata+query→PatternSelector→ChartSelector | パターン/テンプレが矛盾なく決定 |
| **IT-MAP-030** | 処理→マッピング→描画 | processed\_df→DataMapper→ChartBuilder | 正しいエンコーディングで画像生成 |
| **IT-FB-040** | 途中失敗→縮退 | ChartSelector失敗 | 既定テンプレ＋P13で継続成功 |

### 6.3 統合テスト（ST）

### 6.3.1 MCPエンドツーエンド

| TestID | 観点 | 手順 | 期待結果 |
| --- | --- | --- | --- |
| **ST-MCP-001** | 正常系 | JSON-RPCで`chartelier_visualize`呼出（CSV+明確クエリ） | 200相当、画像+metadata（pattern/template/警告） |
| **ST-MCP-002** | エラー系 | ヘッダなしCSV | E400（-32602）＋修正提案 |
| **ST-IMG-003** | 出力形式 | options.format=svg/png | 指定形式で出力、一貫した見た目 |
| **ST-PAT-004** | 9パターン網羅 | クエリとデータを9種用意 | P01..P32表に準拠（該当分） |
| **ST-ERR-005** | LLM障害 | LLMClientモックで5xx/timeout | P13フォールバック＋fallback\_applied=true |
| **ST-DATA-006** | セル超過 | 1,000,001セルのCSV | サンプリング＋警告＋正しく描画 |
| **ST-ENC-007** | UTF-8限定 | 非UTF-8文字含む | E400（encoding） |

### 6.3.2 エラーポリシー／ログ・PII

| TestID | 観点 | 手順 | 期待結果 |
| --- | --- | --- | --- |
| **ST-ERR-010** | エラー分類 | Validation/Business/System発生させる | 正しい`error.code`とJSON-RPCコード |
| **ST-LOG-011** | PII禁止 | 代表失敗時のログ確認 | データ内容/セル値は出力されない |
| **ST-META-012** | メタ情報 | duration\_ms/phase/warnings | 期待キーが埋まり整合性あり |

### 6.4 E2E（ユーザーストーリー）

| TestID | US | 観点 | 手順 | 期待結果 |
| --- | --- | --- | --- | --- |
| **E2E-001** | US-001 | MCPクライアントから即時可視化 | CSV（売上の時系列）＋「推移を可視化」 | 10秒以内でPNG/SVG返却、正しい折れ線（P01/P12） |
| **E2E-002** | US-002 | 明確なエラー情報と代替提案 | 欠損列や型不整合を意図的に投入 | E422＋修正ヒント、P13代替提案 |
| **E2E-003** | US-003 | 日本語/英語クエリ | `ja`/`en`クエリで適切チャート | 言語とチャート選択が意図通り |

## 7. 非機能テスト

### 7.1 性能・スケーラビリティ

| TestID | 観点 | 手順 | 期待結果 |
| --- | --- | --- | --- |
| **NFT-PERF-001** | レイテンシ（P80） | 代表5データセット×各50回、計250リクエストの分布計測 | **P80 < 10s** |
| **NFT-PERF-002** | タイムアウト | 重いデータ＋複雑テンプレを誘発 | 60sでE408\_TIMEOUT、縮退あり |
| **NFT-CONC-003** | 並行100 | 100並行で1分 | エラー無し、スループット目標達成 |
| **NFT-THR-004** | スループット | 1時間持続負荷 | ≥1,000 req/hour維持 |
| **NFT-STATE-001** | ステートレス | 連続2リクエストで前後依存が無いことを確認 | 結果が相互に独立（キャッシュ有無で結果非変化） |

### 7.2 可用性・信頼性

| TestID | 観点 | 手順 | 期待結果 |
| --- | --- | --- | --- |
| **NFT-REL-010** | 成功率 | 正常入力1,000件 | **成功率≥99.9%**（外部LLM障害除く） |
| **NFT-FB-011** | フォールバック | LLM/PNG失敗注入 | 100%でP13 or SVGに縮退 |

### 7.3 運用・監視

| TestID | 観点 | 手順 | 期待結果 |
| --- | --- | --- | --- |
| **NFT-OPS-020** | /health | Liveness | 常に200 |
| **NFT-OPS-021** | /ready | 依存性ダウン | LLM Key失効時に非ready |
| **NFT-OPS-022** | /metrics | Prometheus名の確認 | 設計記載のメトリクスが出力 |
| **NFT-OPS-023** | OTelトレース | 代表フロー | スパン/属性が仕様通り |

## 8. データ設計（テストフィクスチャ）

**CSV最小**（ヘッダ必須）

```
date,category,value
2025-01-01,A,10
2025-01-02,A,12

```

**JSONテーブル（OK）**

```json
[
  {"date":"2025-01-01","category":"A","value":10},
  {"date":"2025-01-02","category":"A","value":12}
]

```

**JSONネスト（NG）**

```json
{"region":{"north":{"sales":[1,2]}}}

```

**境界データ**

- 行=10,000/10,001、列=100/101、セル=1,000,000/1,000,001
- 非UTF-8文字列、区切り子（`,`/`\\t`/`|`）
- 日付フォーマット：`YYYY-MM-DD` / 失敗ケース（`31/01/2025`）
- 欠損率高列、外れ値極端列

**クエリ例（ja/en）**

- 「月次売上の**推移**を出して」→ P01
- 「部門別売上の**比較**」→ P02
- 「リードタイムの**分布**」→ P03
- 「製品別の**時系列比較**」→ P12
- 「**差分**の時系列推移」→ P21
- 「カテゴリ別の**分布比較**」→ P32
- 曖昧：「ざっくり動きを見たい」→ P13

## 9. 実施条件・環境

- **環境**: ローカルDocker / CI（Linux） / ステージングK8s
- **依存**: `vl-convert`（PNG）, LLM API（モック可）
- **フラグ**:
    - `CHARTELIER_DISABLE_LLM=true` → パターン選択を常時P13に固定（LLM回避試験）
    - `CHARTELIER_FORCE_FORMAT=svg|png` → 画像生成フォールバックの検証
    - `CHARTELIER_MAX_CONCURRENCY=8` → HPAと合わせ並行度検証

## 10. 合格基準

- **機能**: ST/E2Eの主要ケース**100%合格**、UT/ITは**95%以上**
- **非機能**: P80<10s、タイムアウト/フォールバック要件、並行100達成、SLO（99.9%）確認
- **エラー**: 全分類とコードの**整合**、ヒント必須
- **運用**: /health, /ready, /metrics, OTelスパンの整合
- **セキュリティ/プライバシ**: PII未記録、ログ/メトリクス項目の遵守

## 11. リスクと迂回策

| リスク | 兆候 | 迂回策 |
| --- | --- | --- |
| LLMレイテンシ変動 | P95悪化 | `DISABLE_LLM=true`でP13固定、プロンプト短縮 |
| PNG依存失敗 | 5xx増 | `FORCE_FORMAT=svg`で運用回避、後日更新 |
| 大容量データ | OOM/遅延 | サンプリングの閾値厳守、セル上限テストの自動化 |
| テンプレ維持コスト | テスト負荷増 | \*\*スナップショット（SVG）\*\*ベースの回帰テスト採用 |

## 12. 自動化・CI戦略

- **Unit/Integration**: pytest（parametrizeで等価分割×境界値を網羅）
- **Contract**: JSON Schemaで**入力/出力/エラー**を検証（MCP/FC/REST）
- **Snapshot**: **SVGスナップショット**と**PNGのpHash/SSIM**で見た目回帰を検出（±しきい値）
- **負荷**: k6/Locustで並行・スループット・P80収集、Prometheusで可視化
- **ゲーティング**:
    - mainマージ時に UT/IT/ST 必須
    - 週次/タグ時に NFT（性能/並行/信頼性）
    - スナップショット差分はレビュー必須

## 13. 代表テストシナリオ詳細（抜粋）

### 13.1 「セル上限超過→サンプリング→描画」

1. 1,000,001セルのCSV＋「推移」クエリ→MCP呼出
2. DataValidatorがセル超過を検出し**等間隔サンプリング**
3. メタデータに`sampled=true`、warningsに「サンプリング通知」
4. 折れ線グラフ生成、画像返却
**期待**: エラーではなく**縮退成功**、メタ/warnings/phase時間が妥当

### 13.2 「LLMタイムアウト→P13フォールバック」

1. LLMClientをtimeoutモック
2. PatternSelectorでP13、ChartSelectorは既定テンプレ
3. 正常にP13チャート（ファセット×ヒストグラム）返却
**期待**: `metadata.fallback_applied=true`、エラーなし

### 13.3 「PNG失敗→SVGフォールバック」

1. ChartBuilderのPNGエクスポートで意図的に失敗
2. export再試行でSVGに切替
**期待**: 画像返却（SVG）、warning記録、ログに例外だが**PIIなし**

## 14. 9パターン網羅チェックリスト

| ID | 第1意図 | 第2意図 | 既定グラフ | 代表データ/クエリ |
| --- | --- | --- | --- | --- |
| **P01** | 推移 | - | 折れ線 | 「売上の推移」単系列 |
| **P02** | 差異 | - | 棒 | 「部門別の比較」 |
| **P03** | 概要 | - | ヒスト | 「リードタイムの分布」 |
| **P12** | 推移 | 差異 | 複数折れ線 | 「製品別の時系列比較」 |
| **P13** | 推移 | 概要 | ファセット×ヒスト | 「ざっくり動きと分布」 |
| **P21** | 差異 | 推移 | グループ化棒 | 「差分の時間推移」 |
| **P23** | 差異 | 概要 | オーバーレイヒスト | 「カテゴリ別の分布比較」 |
| **P31** | 概要 | 推移 | Small multiples | 「全体像の時間変化」 |
| **P32** | 概要 | 差異 | 並列箱ひげ | 「分布のカテゴリ比較」 |

# Visualization Policy

## 0. 目的と適用範囲

LLM/エージェントが**誠実で再現可能な**可視化を出力するための**強制ルール**。人間の微調整を前提としないテンプレート実装（Altair）に組み込み、MVPの\*\*標準出力（PNG/SVG）\*\*に適用する。原則は官公庁ガイドラインとWCAGを基準に採用し、ライセンス再利用性を重視する。\[1]\[7]\[8]

## 1. 採用する原則（Mandatory）

* **軸とスケール**

  * **棒/エリアは0起点**。**折れ線/散布は0起点を強制しない**（趨勢が読める範囲で軸を切る）。複数図比較は**軸スケールを揃える**。\[1]

* **二重軸の回避**

  * **Dual‑axisは使用しない**。必要なら**図を分ける**か**索引化/注釈**で代替。\[1]\[2]\[11]

* **不確実性の表現**

  * **区間（帯/ヒゲ/陰影）で示す。誤読を招くエラーバーの乱用を避ける。注記で母数・推定法**を明示。\[4]

* **テキストとラベル**

  * **直接ラベル**（可能な限り凡例を避ける）。**水平文字**、必要最小の注釈。タイトル/サブで**要点先出し**。\[5]

* **色とコントラスト**

  * **色だけに依存しない**（線種/マーカー併用）。コントラスト**WCAG 2.x**準拠（本文4.5:1、非テキスト3:1 目安）。**色覚多様性配慮**パレットを既定採用。\[8]\[9]

* **テキスト代替**

  * **本文に記述的な代替テキスト**（主要メッセージ/範囲/例外/出典）。`alt`は**空**＋装飾扱いを原則（重複読み上げ回避）。\[6]

* **シンプルさ**

  * 不要な装飾（3D、過剰グリッド、強調の乱用）を排除。\[3]\[12]

## 2. 禁止/制限

* **禁止**：**二重軸**、**3D**、**レーダー**。**円/ドーナツ**は**MVPでは不採用**（分割棒/100%積み上げ等に置換）。\[1]\[2]\[11]

* **系列/カテゴリ上限**：同時表示は**少数精鋭**（折れ線≤\~4、積み上げ≤\~4目安）。超過時は**Top‑K＋Other**、**スモールマルチプル**へ分割。\[5]

* **地図・ネットワーク**：MVP対象外（将来フェーズ）。

（根拠: \[1]\[5]\[11]）

## 3. テンプレ実装への落とし込み

* **強制チェック**：

  1. グラフ型と軸規則（0起点/縮尺/非線形禁止）
  2. 二重軸・3D・レーダーの**ブロック**
  3. 凡例→**直接ラベル**への自動切替（閾値超過時）
  4. **色覚対応**パレット（ColorBrewer系）＋WCAGコントラスト検証
  5. **本文用要約**（主要メッセージ/範囲/注意/出典）を出力メタに同梱

* **フォールバック**：要件未充足時は**より単純な型**（例：積み上げ→グループ棒→棒）。

* **ロギング**：規約適合/置換理由/代替案を**Explain Log**に記録。

（参照: \[1]\[6]\[8]）

## 4. 推奨資産

* **USWDS**（米政府）— **Public Domain/CC0**。図表/アクセシビリティ指針の参照に適す。\[7]

* **ONS / Government Analysis Function（UK）**— **OGL v3.0**。原則/チェックリスト/色指針を再利用可（要帰属）。\[1]\[2]\[3]

* **FT Visual Vocabulary**— **CC BY‑SA 4.0**。目的→図法の対応表を参考に、内部「パターン→グラフ」マップの整合を確認。\[10]

* **ColorBrewer 2.0**— **Apache‑2.0**。色覚対応パレットの既定採用に適す。\[9]

* **WCAG 2.x**— 標準規格。\*\*1.4.3（最小コントラスト）/1.4.11（非テキスト）/1.1.1（代替テキスト）\*\*を準拠基準にする。\[8]

## 5. 既定グラフの適用ルール（例）

* **推移のみ**：折れ線（必要に応じ軸切り上げ）。異常/目標は注釈や帯で示す。\[1]\[4]
* **差異のみ**：棒（0起点厳守）。順序付与（大小/論理）。\[1]
* **概要のみ/分布**：箱ひげ/ヒストグラム（区間は自動ビン幅）。\[4]
* **相関**：散布＋回帰線。凡例不要、直接ラベル。\[5]

（根拠: \[1]\[4]\[5]）

## 参考文献

\[1] ONS, *Chart details: Axes and gridlines*.<br>
\[2] Government Analysis Function, *Data visualisation: charts*.<br>
\[3] ONS, *Overall considerations: Principles*.<br>
\[4] ONS, *Showing uncertainty in charts*.<br>
\[5] Government Analysis Function, *Accessible charts: a checklist of the basics*.<br>
\[6] GOV.UK Accessibility blog, *Text descriptions for data visualisations*.<br>
\[7] U.S. Web Design System, *Data visualizations*（Public Domain/CC0）.<br>
\[8] W3C, *Web Content Accessibility Guidelines (WCAG) 2.1*.<br>
\[9] ColorBrewer 2.0, *License (Apache‑2.0)*.<br>
\[10] Financial Times, *Visual Vocabulary*（CC BY‑SA 4.0）.<br>
\[11] Datawrapper, *Why not to use two axes, and what to use instead*.<br>
\[12] Wikipedia, *Misleading graph*.

---
